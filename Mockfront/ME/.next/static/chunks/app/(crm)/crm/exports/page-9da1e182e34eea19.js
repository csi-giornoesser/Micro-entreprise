(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4681],{1941:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var t=a(5155),l=a(2115),r=a(2619);function n(){let[e,s]=(0,l.useState)([]),[a,n]=(0,l.useState)([]),[o,i]=(0,l.useState)(!0),[d,c]=(0,l.useState)({status:"all",partnerId:"all",operatorId:"all",dateFrom:"",dateTo:""}),[m,u]=(0,l.useState)({partnerId:"all",dateFrom:"",dateTo:"",groupBy:"dossier"}),[p,x]=(0,l.useState)({dateFrom:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().slice(0,10),dateTo:new Date().toISOString().slice(0,10),type:"summary"});async function h(){let e=new URLSearchParams;"all"!==d.status&&e.set("status",d.status),"all"!==d.partnerId&&e.set("partnerId",d.partnerId),"all"!==d.operatorId&&e.set("operatorId",d.operatorId),d.dateFrom&&e.set("from",d.dateFrom),d.dateTo&&e.set("to",d.dateTo),e.set("format","csv"),f("/api/exports/dossiers?".concat(e.toString()),"dossiers_".concat(new Date().toISOString().slice(0,10),".csv"))}async function j(){let e=new URLSearchParams;"all"!==m.partnerId&&e.set("partnerId",m.partnerId),m.dateFrom&&e.set("from",m.dateFrom),m.dateTo&&e.set("to",m.dateTo),e.set("groupBy",m.groupBy),e.set("format","csv"),f("/api/exports/commissions?".concat(e.toString()),"commissions_".concat(m.groupBy,"_").concat(new Date().toISOString().slice(0,10),".csv"))}async function g(){let e=new URLSearchParams;p.dateFrom&&e.set("from",p.dateFrom),p.dateTo&&e.set("to",p.dateTo),e.set("type",p.type),e.set("format","csv"),f("/api/exports/activite?".concat(e.toString()),"rapport_activite_".concat(p.type,"_").concat(new Date().toISOString().slice(0,10),".csv"))}function f(e,s){let a=document.createElement("a");a.href=e,a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a)}return((0,l.useEffect)(()=>{!async function(){try{let e=await fetch("/api/dashboard",{cache:"no-store"});if(e.ok){let a=await e.json();s(a.partenaires||[]),n(a.operateurs||[])}}catch(e){console.error("Erreur chargement r\xe9f\xe9rences:",e)}finally{i(!1)}}()},[]),o)?(0,t.jsx)("main",{className:"p-6",children:"Chargement..."}):(0,t.jsxs)("main",{className:"p-6 space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"\uD83D\uDCCA Exports & Rapports"}),(0,t.jsx)(r,{href:"/crm/dashboard",className:"text-sm text-blue-600 underline",children:"← Retour dashboard"})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("section",{className:"border rounded p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:"\uD83D\uDCC1 Export Dossiers"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Export d\xe9taill\xe9 des dossiers avec filtres personnalisables. Id\xe9al pour analyses et audits."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Statut"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:d.status,onChange:e=>c(s=>({...s,status:e.target.value})),children:[(0,t.jsx)("option",{value:"all",children:"Tous les statuts"}),(0,t.jsx)("option",{value:"nouveau",children:"Nouveau"}),(0,t.jsx)("option",{value:"en_cours",children:"En cours"}),(0,t.jsx)("option",{value:"en_attente",children:"En attente"}),(0,t.jsx)("option",{value:"a_corriger",children:"\xc0 corriger"}),(0,t.jsx)("option",{value:"valide",children:"Valid\xe9"}),(0,t.jsx)("option",{value:"rejete",children:"Rejet\xe9"})]})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Partenaire"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:d.partnerId,onChange:e=>c(s=>({...s,partnerId:e.target.value})),children:[(0,t.jsx)("option",{value:"all",children:"Tous les partenaires"}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nom},e.id))]})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Op\xe9rateur"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:d.operatorId,onChange:e=>c(s=>({...s,operatorId:e.target.value})),children:[(0,t.jsx)("option",{value:"all",children:"Tous les op\xe9rateurs"}),a.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nom},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Du"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:d.dateFrom,onChange:e=>c(s=>({...s,dateFrom:e.target.value}))})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Au"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:d.dateTo,onChange:e=>c(s=>({...s,dateTo:e.target.value}))})]})]}),(0,t.jsx)("button",{className:"w-full bg-blue-600 text-white py-2 rounded",onClick:h,children:"\uD83D\uDCE5 T\xe9l\xe9charger CSV Dossiers"})]})]}),(0,t.jsxs)("section",{className:"border rounded p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:"\uD83D\uDCB0 Export Commissions"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Export des commissions pour facturation partenaires et r\xe9conciliation comptable."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Type d'export"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:m.groupBy,onChange:e=>u(s=>({...s,groupBy:e.target.value})),children:[(0,t.jsx)("option",{value:"dossier",children:"Par dossier (d\xe9taill\xe9)"}),(0,t.jsx)("option",{value:"partner",children:"Par partenaire (group\xe9)"}),(0,t.jsx)("option",{value:"month",children:"Par mois (\xe9volution)"})]})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Partenaire"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:m.partnerId,onChange:e=>u(s=>({...s,partnerId:e.target.value})),children:[(0,t.jsx)("option",{value:"all",children:"Tous les partenaires"}),e.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nom},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Du"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:m.dateFrom,onChange:e=>u(s=>({...s,dateFrom:e.target.value}))})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Au"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:m.dateTo,onChange:e=>u(s=>({...s,dateTo:e.target.value}))})]})]}),(0,t.jsx)("button",{className:"w-full bg-green-600 text-white py-2 rounded",onClick:j,children:"\uD83D\uDCB0 T\xe9l\xe9charger CSV Commissions"})]})]}),(0,t.jsxs)("section",{className:"border rounded p-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:"\uD83D\uDCC8 Rapport d'Activit\xe9"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Rapports de synth\xe8se pour direction : KPIs, performance partenaires, \xe9volution activit\xe9."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Type de rapport"}),(0,t.jsxs)("select",{className:"border rounded p-2",value:p.type,onChange:e=>x(s=>({...s,type:e.target.value})),children:[(0,t.jsx)("option",{value:"summary",children:"Synth\xe8se par mois"}),(0,t.jsx)("option",{value:"performance",children:"Performance partenaires"}),(0,t.jsx)("option",{value:"detailed",children:"D\xe9taill\xe9 par dossier"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Du"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:p.dateFrom,onChange:e=>x(s=>({...s,dateFrom:e.target.value}))})]}),(0,t.jsxs)("label",{className:"flex flex-col text-sm",children:[(0,t.jsx)("span",{className:"mb-1 font-medium",children:"Au"}),(0,t.jsx)("input",{type:"date",className:"border rounded p-2",value:p.dateTo,onChange:e=>x(s=>({...s,dateTo:e.target.value}))})]})]}),(0,t.jsx)("button",{className:"w-full bg-purple-600 text-white py-2 rounded",onClick:g,children:"\uD83D\uDCC8 T\xe9l\xe9charger Rapport"})]})]})]}),(0,t.jsxs)("section",{className:"bg-blue-50 border border-blue-200 rounded p-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"\uD83D\uDCA1 Guide d'utilisation"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"\uD83D\uDCC1 Export Dossiers"}),(0,t.jsxs)("ul",{className:"list-disc pl-4 space-y-1 text-gray-600",children:[(0,t.jsx)("li",{children:"Analyse d\xe9taill\xe9e par dossier"}),(0,t.jsx)("li",{children:"Filtrage par statut/partenaire"}),(0,t.jsx)("li",{children:"Id\xe9al pour audits et suivis"}),(0,t.jsx)("li",{children:"Compatible Excel/LibreOffice"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"\uD83D\uDCB0 Export Commissions"}),(0,t.jsxs)("ul",{className:"list-disc pl-4 space-y-1 text-gray-600",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Par dossier:"})," Facturation d\xe9taill\xe9e"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Par partenaire:"})," R\xe9conciliation"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Par mois:"})," \xc9volution CA"]}),(0,t.jsx)("li",{children:"Pr\xeat pour comptabilit\xe9"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"\uD83D\uDCC8 Rapport Activit\xe9"}),(0,t.jsxs)("ul",{className:"list-disc pl-4 space-y-1 text-gray-600",children:[(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Synth\xe8se:"})," KPIs mensuels"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"Performance:"})," Comparaison partenaires"]}),(0,t.jsxs)("li",{children:[(0,t.jsx)("strong",{children:"D\xe9taill\xe9:"})," Analyse op\xe9rationnelle"]}),(0,t.jsx)("li",{children:"Pour rapports direction"})]})]})]})]}),(0,t.jsxs)("section",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"⚡ Actions rapides"}),(0,t.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,t.jsx)("button",{className:"border rounded px-4 py-2 text-sm",onClick:()=>{let e=new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().slice(0,10),s=new Date().toISOString().slice(0,10);c(a=>({...a,dateFrom:e,dateTo:s}))},children:"\uD83D\uDCC5 Dossiers du mois"}),(0,t.jsx)("button",{className:"border rounded px-4 py-2 text-sm",onClick:()=>{u(e=>({...e,groupBy:"partner"}))},children:"✅ Commissions \xe0 facturer"}),(0,t.jsx)("button",{className:"border rounded px-4 py-2 text-sm",onClick:()=>{let e=new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().slice(0,10),s=new Date().toISOString().slice(0,10);x(a=>({...a,dateFrom:e,dateTo:s,type:"summary"}))},children:"\uD83D\uDCCA Rapport mensuel"})]})]})]})}},8382:(e,s,a)=>{Promise.resolve().then(a.bind(a,1941))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=8382)),_N_E=e.O()}]);