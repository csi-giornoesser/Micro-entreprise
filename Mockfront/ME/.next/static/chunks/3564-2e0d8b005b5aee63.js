"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3564],{3247:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(5155);let l=e=>(null!=e?e:0===e)?String(e):"—";function n(e){let{pieces:t=[],downloads:s=[],requiredTypes:n=[]}=e,a=t.length,r=t.filter(e=>"valide"===e.statut).length,d=n.length?n.filter(e=>!t.some(t=>t.type===e)):[];return(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCC4 Pi\xe8ces justificatives"}),(0,i.jsxs)("div",{className:"bg-white border rounded p-4",children:[(0,i.jsxs)("div",{className:"text-sm mb-3",children:[(0,i.jsx)("strong",{children:"Statut:"})," ",r,"/",a," valid\xe9es",n.length?(0,i.jsxs)("span",{className:"ml-2",children:["— Requises manquantes: ",d.length?d.join(", "):"—"]}):null]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:a?t.map((e,t)=>{let s;return(0,i.jsxs)("li",{children:[l(e.type)," — ",l(e.fichier)," — ",l(e.statut),e.motif_refus?" (".concat(e.motif_refus,")"):""," ",e.uploaded_at?"(".concat((s=e.uploaded_at)?new Date(s).toISOString().slice(0,10):"—",")"):""]},t)}):(0,i.jsx)("li",{children:"—"})}),(0,i.jsx)("h4",{className:"font-medium mt-3",children:"T\xe9l\xe9chargements disponibles"}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:s.length?s.map((e,t)=>(0,i.jsxs)("li",{children:[l(e.type)," — ",l(e.fichier)]},t)):(0,i.jsx)("li",{children:"—"})})]})]})}},4101:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(5155),l=s(2115);let n=e=>e?new Date(e).toLocaleDateString("fr-FR"):null,a=["formulaire","pieces","mandat","transmission","traitement","siren","attestation"];function r(e){var t,s,r,d,c,o;let{dossier:u}=e,[m,x]=(0,l.useState)(null),[p,h]=(0,l.useState)(!0),[g,v]=(0,l.useState)(null),[j,f]=(0,l.useState)(null),[b,N]=(0,l.useState)(!0),[y,_]=(0,l.useState)(null);(0,l.useEffect)(()=>{(null==u?void 0:u.id)&&(D(),w())},[null==u?void 0:u.id]);let D=(0,l.useCallback)(async()=>{h(!0),v(null);try{let e=await fetch("/api/dossiers/".concat(u.id,"/timeline"),{cache:"no-store"});if(!e.ok)throw Error("HTTP ".concat(e.status));let t=await e.json();x(t)}catch(e){console.error("Erreur chargement timeline:",e),v("Impossible de charger les d\xe9tails du suivi")}finally{h(!1)}},[null==u?void 0:u.id]),w=(0,l.useCallback)(async()=>{N(!0);try{let e=await fetch("/api/dossiers/".concat(u.id,"/pieces"),{cache:"no-store"});if(!e.ok)throw Error("HTTP ".concat(e.status));let t=await e.json();f(t)}catch(e){console.error("Erreur chargement pi\xe8ces:",e)}finally{N(!1)}},[null==u?void 0:u.id]),S=(0,l.useCallback)(e=>{var t;return null==j||null==(t=j.pieces_state)?void 0:t.find(t=>t.piece_key===e)},[j]),C=(0,l.useCallback)(e=>{var t;return null==j||null==(t=j.pieces_expected)?void 0:t.find(t=>t.piece_key===e)},[j]),E=(0,l.useMemo)(()=>{if(!j)return"pending";let e=new Set((j.pieces_expected||[]).filter(e=>"MandatSigne"!==e.piece_key&&!1!==e.required).map(e=>e.piece_key)),t=(j.pieces_state||[]).filter(e=>"MandatSigne"!==e.piece_key);return 0===t.length?"pending":[...e].every(e=>{let s=t.find(t=>t.piece_key===e);return s&&("valide"===s.status||"en_attente"===s.status)})?"completed":"pending"},[j]),A=(0,l.useMemo)(()=>{let e=S("MandatSigne");return e&&("valide"===e.status||"en_attente"===e.status)?"completed":"pending"},[S]),k=(0,l.useCallback)(async e=>{var t;if((null==u?void 0:u.id)&&!y&&(null==j||null==(t=j.capabilities)?void 0:t.canUpload)!==!1)try{let t=document.createElement("input");t.type="file";let s=C(e);t.accept=(Array.isArray(null==s?void 0:s.accept_ext)?s.accept_ext:[".pdf",".jpg",".jpeg",".png"]).join(","),t.style.display="none",document.body.appendChild(t),t.onchange=async s=>{var i;let l=null==(i=s.target.files)?void 0:i[0];if(!l)return document.body.removeChild(t);if(l.size>0xa00000)return alert("❌ Fichier trop volumineux (max 10MB)"),document.body.removeChild(t);try{_(e);let t=new FormData;t.append("file",l);let s=await fetch("/api/dossiers/".concat(u.id,"/pieces/").concat(encodeURIComponent(e),"/upload"),{method:"POST",body:t});if(!s.ok){let e=await s.json().catch(()=>({})),t=(null==e?void 0:e.error_code)?" [".concat(e.error_code,"]"):"";throw Error(((null==e?void 0:e.error)||"HTTP ".concat(s.status))+t)}await w(),alert("✅ Fichier upload\xe9 avec succ\xe8s !")}catch(e){alert("❌ Upload \xe9chou\xe9: ".concat(e.message))}finally{_(null),t.value="",document.body.contains(t)&&document.body.removeChild(t)}},t.click()}catch(e){_(null),alert("❌ Erreur: ".concat(e.message))}},[null==u?void 0:u.id,y,null==j||null==(t=j.capabilities)?void 0:t.canUpload,C,w]),R=(0,l.useCallback)(async e=>{try{let t=await fetch("/api/dossiers/".concat(u.id,"/documents/").concat(e,"/download"));if(!t.ok)throw Error("Document non disponible");let s=await t.blob(),i=window.URL.createObjectURL(s),l=document.createElement("a");l.href=i,l.download="".concat(e,"_").concat(u.id,".pdf"),document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(i),document.body.removeChild(l)}catch(e){console.error("Erreur t\xe9l\xe9chargement:",e),alert("❌ Impossible de t\xe9l\xe9charger le document")}},[null==u?void 0:u.id]),I=(0,l.useCallback)(async()=>{if(null==u?void 0:u.id)try{let e=await fetch("/api/dossiers/".concat(u.id,"/etapes/formulaire/completer"),{method:"POST"});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error((null==t?void 0:t.error)||"HTTP ".concat(e.status))}await D()}catch(e){alert("❌ ".concat(e.message||"Erreur"))}},[null==u?void 0:u.id,D]),M=(0,l.useMemo)(()=>{var e,t,s;let i;if(!m)return[];let{timeline_steps:l,documents_officiels:n}=m,a=null==l?void 0:l.find(e=>"formulaire"===e.id),r=null!=(s=null==a?void 0:a.done)?s:!!(null==u?void 0:u.date_creation),d=(null==a?void 0:a.date)||(null==u?void 0:u.date_creation)||null,c=((null==j?void 0:j.pieces_state)||[]).filter(e=>"MandatSigne"!==e.piece_key),o=c.filter(e=>"valide"===e.status||"en_attente"===e.status),x=o.map(e=>e.uploaded_at).filter(Boolean).map(e=>new Date(e).getTime()).sort((e,t)=>t-e)[0],p=x?new Date(x):null,h=S("MandatSigne"),g=(l||[]).find(e=>"transmission"===e.id),v=(null==g?void 0:g.status)||"pending",f=(null==g?void 0:g.date)||null,N=(l||[]).find(e=>"processing"===e.id),y=(null==N?void 0:N.status)||"pending",_=(null==N?void 0:N.date)||null;return[{id:"formulaire",title:"Formulaire rempli",description:r?"Vos informations ont \xe9t\xe9 enregistr\xe9es":"Informations \xe0 compl\xe9ter",status:r?"completed":"pending",icon:"\uD83D\uDCDD",date:d},{id:"pieces",title:"Pi\xe8ces requises",description:b?"Chargement des pi\xe8ces…":"completed"===E?"Toutes les pi\xe8ces requises sont envoy\xe9es":"".concat(o.length," / ").concat(c.length," pi\xe8ces upload\xe9es"),status:E,icon:"\uD83D\uDCC4",date:"completed"===E?p:null},{id:"mandat",title:"Mandat sign\xe9",description:"completed"===A?"Mandat upload\xe9".concat((null==h?void 0:h.uploaded_at)?" le "+((i=h.uploaded_at)?new Date(i).toLocaleString("fr-FR"):null):""):"Mandat \xe0 signer",status:A,icon:"✍️",date:(null==h?void 0:h.uploaded_at)||null},{id:"transmission",title:"Dossier transmis",description:"completed"===v?"Dossier transmis aux administrations":"En attente de transmission",status:v,icon:"\uD83D\uDCE4",date:f},{id:"traitement",title:"Dossier en cours de traitement",description:"V\xe9rification par les administrations",status:y,icon:"\uD83C\uDFDB️",date:_},{id:"siren",title:"SIREN attribu\xe9",description:"Num\xe9ro d'identification re\xe7u",status:(null==n?void 0:n.some(e=>{var t,s,i,l;return"Avis de situation SIRENE"===e.type||(null==(s=e.type)||null==(t=s.toUpperCase())?void 0:t.includes("SIRENE"))||(null==(l=e.type)||null==(i=l.toUpperCase())?void 0:i.includes("SIREN"))}))?"completed":"pending",icon:"\uD83C\uDD94",date:(null==n||null==(e=n.find(e=>{var t,s,i,l;return"Avis de situation SIRENE"===e.type||(null==(s=e.type)||null==(t=s.toUpperCase())?void 0:t.includes("SIRENE"))||(null==(l=e.type)||null==(i=l.toUpperCase())?void 0:i.includes("SIREN"))}))?void 0:e.date)||null},{id:"attestation",title:"Attestation \xe0 t\xe9l\xe9charger",description:"Tous vos documents sont pr\xeats",status:(null==n?void 0:n.some(e=>{var t;return"Attestation URSSAF"===e.type||(null==(t=e.type)?void 0:t.includes("Attestation"))}))&&(null==u?void 0:u.statut)==="valide"?"completed":(null==n?void 0:n.some(e=>{var t;return"Attestation URSSAF"===e.type||(null==(t=e.type)?void 0:t.includes("Attestation"))}))?"active":"pending",icon:"\uD83C\uDF89",date:(null==n||null==(t=n.find(e=>{var t;return"Attestation URSSAF"===e.type||(null==(t=e.type)?void 0:t.includes("Attestation"))}))?void 0:t.date)||null}]},[m,null==u?void 0:u.date_creation,null==u?void 0:u.statut,j,b,S,A,E]),F=(0,l.useMemo)(()=>[...M].sort((e,t)=>a.indexOf(e.id)-a.indexOf(t.id)),[M]),{completed:T,total:U,raw:P,percent:q}=(0,l.useMemo)(()=>(function(e){let t=e.length,s=e.filter(e=>"completed"===e.status).length,i=t?s/t*100:0;return{completed:s,total:t,raw:i,percent:Math.round(i)}})(F),[F]),L=Math.round(P);return u?p?(0,i.jsxs)("section",{className:"border rounded p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCCD Suivi de votre micro-entreprise"}),(0,i.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,i.jsx)("div",{className:"text-sm text-gray-600",children:"\uD83D\uDD04 Chargement du suivi..."})})]}):g?(0,i.jsxs)("section",{className:"border rounded p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCCD Suivi de votre micro-entreprise"}),(0,i.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[(0,i.jsxs)("div",{className:"text-red-800",children:["❌ ",g]}),(0,i.jsx)("button",{onClick:D,className:"mt-2 text-sm bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",children:"\uD83D\uDD04 R\xe9essayer"})]})]}):(0,i.jsxs)("section",{className:"border rounded p-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"\uD83D\uDCCD Suivi de votre micro-entreprise"}),(0,i.jsxs)("div",{className:"mb-3 text-xs p-2 rounded border bg-gray-50 text-gray-700",children:[(0,i.jsx)("div",{children:(0,i.jsx)("b",{children:"Calcul progression"})}),(0,i.jsxs)("div",{children:["completed: ",T," / total: ",U," → raw: ",P.toFixed(2),"% → affich\xe9: ",L,"%"]}),(0,i.jsx)("div",{className:"mt-1",children:F.map(e=>(0,i.jsxs)("span",{className:"inline-block mr-2 mt-1 px-2 py-0.5 rounded border",children:[e.id,": ",(0,i.jsx)("b",{children:e.status})]},e.id))})]}),(0,i.jsxs)("div",{className:"text-sm text-right",children:[(0,i.jsxs)("span",{className:"font-medium",children:[L,"% termin\xe9"]}),(0,i.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1","aria-hidden":"true",children:(0,i.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(L,"%")}})}),(null==m||null==(s=m.metrics)?void 0:s.estimated_completion)&&(0,i.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["Finalisation estim\xe9e: ",n(m.metrics.estimated_completion)]})]})]}),(null==u||null==(r=u.blocages)?void 0:r.length)>0&&(0,i.jsxs)("div",{className:"mb-4 p-3 rounded border bg-orange-50 text-orange-800",children:[(0,i.jsx)("span",{className:"mr-2",children:"⚠️"}),(0,i.jsx)("strong",{children:"Action requise :"})," ",u.blocages.join(", ")]}),(0,i.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("span",{className:"text-2xl",children:"valide"===u.statut?"\uD83C\uDF89":"rejete"===u.statut?"❌":(null==(d=u.blocages)?void 0:d.length)>0?"⚠️":"\uD83D\uDD04"}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:"font-semibold text-lg",children:"valide"===u.statut?"F\xe9licitations ! Votre micro-entreprise est cr\xe9\xe9e !":"rejete"===u.statut?"Dossier rejet\xe9 - Contactez votre conseiller":(null==(c=u.blocages)?void 0:c.length)>0?"Action requise de votre part":"Votre dossier est en cours de traitement"}),(0,i.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Statut: ",(0,i.jsx)("strong",{children:u.statut})," • Dossier #",u.id]})]}),(0,i.jsx)("button",{onClick:()=>{D(),w()},className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",disabled:p||b,"aria-label":"Actualiser le suivi","aria-busy":p||b,children:"\uD83D\uDD04 Actualiser"})]})}),(0,i.jsx)("div",{className:"space-y-6",children:F.map((e,t)=>{var s;return(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:(e=>{let t="flex items-center justify-center w-10 h-10 rounded-full text-sm font-medium";return"completed"===e?"".concat(t," bg-green-500 text-white"):"active"===e?"".concat(t," bg-blue-500 text-white animate-pulse"):"warning"===e?"".concat(t," bg-orange-500 text-white"):"error"===e?"".concat(t," bg-red-500 text-white"):"".concat(t," bg-gray-300 text-gray-600")})(e.status),children:e.icon}),t<F.length-1&&(0,i.jsx)("div",{className:"w-1 h-12 mt-2 ".concat("completed"===(s=e.status)||"active"===s?"bg-green-300":"warning"===s?"bg-orange-300":"error"===s?"bg-red-300":"bg-gray-200")})]}),(0,i.jsxs)("div",{className:"flex-1 pb-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,i.jsx)("h4",{className:"font-semibold text-lg",children:e.title}),e.date&&(0,i.jsx)("span",{className:"text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",title:new Date(e.date).toISOString(),children:n(e.date)})]}),(0,i.jsx)("p",{className:"text-gray-600 mb-2",children:e.description}),"formulaire"===e.id&&"completed"!==e.status&&(0,i.jsx)("button",{onClick:I,className:"px-3 py-1.5 rounded text-xs font-medium border bg-blue-600 text-white hover:bg-blue-700",children:"✅ Marquer le formulaire comme fait"}),"pieces"===e.id&&!b&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:((null==j?void 0:j.pieces_state)||[]).filter(e=>"MandatSigne"!==e.piece_key).map(e=>{var t;let s="valide"===e.status||"en_attente"===e.status,l=(null==j||null==(t=j.capabilities)?void 0:t.canUpload)!==!1,n=y===e.piece_key||"valide"===e.status||!l,a=C(e.piece_key),r=Array.isArray(null==a?void 0:a.accept_ext)?a.accept_ext.join(", "):"pdf, jpg, png",d=("valide"===e.status?"Valid\xe9e":"en_attente"===e.status?"En revue":"refusee"===e.status?"Refus\xe9e".concat(e.reason?" — "+e.reason:""):"\xc0 fournir")+" • Formats: ".concat(r);return(0,i.jsx)("button",{onClick:()=>k(e.piece_key),disabled:n,title:d,className:"px-3 py-1.5 rounded text-xs font-medium border transition disabled:opacity-50 ".concat(s?"bg-green-50 text-green-800 border-green-200 hover:bg-green-100":"bg-red-50 text-red-800 border-red-200 hover:bg-red-100"),children:y===e.piece_key?"\uD83D\uDCE4 Envoi…":e.piece_label||e.piece_key},e.piece_key)})}),(0,i.jsx)("div",{className:"mt-1 text-[11px] text-gray-500",children:"\uD83D\uDFE2 Upload\xe9 / en revue • \uD83D\uDD34 \xc0 uploader"})]}),"mandat"===e.id&&(0,i.jsx)("div",{className:"flex items-center gap-2",children:(()=>{var e;let t=S("MandatSigne"),s=(null==t?void 0:t.status)||"missing",l="valide"===s||"en_attente"===s,n=(null==j||null==(e=j.capabilities)?void 0:e.canUpload)!==!1,a=C("MandatSigne"),r=Array.isArray(null==a?void 0:a.accept_ext)?a.accept_ext.join(", "):"pdf, jpg, png",d=("valide"===s?"Mandat valid\xe9":"en_attente"===s?"En revue":"refusee"===s?"Refus\xe9".concat((null==t?void 0:t.reason)?" — "+t.reason:""):"\xc0 fournir")+" • Formats: ".concat(r);return(0,i.jsx)("button",{onClick:()=>k("MandatSigne"),disabled:"MandatSigne"===y||"valide"===s||!n,title:d,className:"px-3 py-1.5 rounded text-xs font-medium border transition disabled:opacity-50 ".concat(l?"bg-green-50 text-green-800 border-green-200 hover:bg-green-100":"bg-red-50 text-red-800 border-red-200 hover:bg-red-100"),children:"MandatSigne"===y?"\uD83D\uDCE4 Envoi…":l?"Mandat ✅":"Uploader le mandat"})})()}),"siren"===e.id&&"completed"===e.status&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("button",{onClick:()=>R("sirene"),className:"px-3 py-1.5 rounded text-xs font-semibold bg-green-600 text-white hover:bg-green-700",children:"\uD83D\uDCE5 T\xe9l\xe9charger l'avis SIRENE"})}),"attestation"===e.id&&"completed"===e.status&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("button",{onClick:()=>R("attestation"),className:"px-3 py-1.5 rounded text-xs font-semibold bg-green-600 text-white hover:bg-green-700",children:"\uD83D\uDCE5 T\xe9l\xe9charger l'attestation"})})]})]},e.id)})}),(0,i.jsx)("div",{className:"mt-4 pt-3 border-t bg-gray-50 -m-4 p-4 rounded-b",children:(0,i.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Cr\xe9\xe9 le:"}),(0,i.jsx)("br",{}),n(u.date_creation)]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Derni\xe8re MAJ:"}),(0,i.jsx)("br",{}),n(u.derniere_modification)]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"Documents g\xe9n\xe9r\xe9s:"}),(0,i.jsx)("br",{}),(null==m||null==(o=m.metrics)?void 0:o.documents_officiels_count)||0]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"font-medium",children:"R\xe9f\xe9rence:"}),(0,i.jsx)("br",{}),"#",u.id]})]})})]}):(0,i.jsxs)("section",{className:"border rounded p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCCD Suivi de votre dossier"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Aucun dossier s\xe9lectionn\xe9"})]})}},5392:(e,t,s)=>{s.d(t,{A:()=>c});var i=s(5155),l=s(2619);function n(e){if(!e)return"—";let t=new Date(e);if(!Number.isFinite(t.getTime()))return"—";try{return t.toLocaleDateString("fr-FR")}catch(e){return"—"}}let a=e=>{let t=function(e){if(!0===e||!1===e)return e;if(1===e||0===e)return!!e;if("string"==typeof e){let t=e.trim().toLowerCase();if("true"===t||"oui"===t)return!0;if("false"===t||"non"===t)return!1}}(e);return!0===t?"Oui":!1===t?"Non":"—"},r=e=>(null!=e?e:0===e)?String(e):"—";function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:", ",s=e.map(e=>(null!=e?e:0===e)?String(e):"").map(e=>e.trim()).filter(e=>e&&"—"!==e);return s.length?s.join(t):"—"}function c(e){var t,s,c,o,u,m,x,p,h,g,v,j,f,b,N,y,_,D,w,S,C,E,A,k,R,I,M,F,T,U,P,q,L,O,V,H,B,J,z,W,G,K,Q,X,Y,Z,$,ee,et,es;let{data:ei}=e;if(!(null==ei?void 0:ei.entreprise))return null;let el=ei.entreprise,en=Array.isArray(ei.documents_generes)?ei.documents_generes:[],ea=Array.isArray(ei.scraping_jobs)?ei.scraping_jobs:[],er=Array.isArray(ei.dossiers)?ei.dossiers:[],ed=null!=(S=null!=(w=null==(t=el.donnees_gouvernement)?void 0:t.guichet_unique_INPI)?w:el.gov_inpi)?S:{},ec=null!=(E=null!=(C=null==(s=el.donnees_gouvernement)?void 0:s.INSEE_SIRENE)?C:el.gov_insee)?E:{},eo=null!=(k=null!=(A=null==(c=el.donnees_gouvernement)?void 0:c.URSSAF)?A:el.gov_urssaf)?k:{},eu=null!=(I=null!=(R=null==(o=el.donnees_gouvernement)?void 0:o.RNE)?R:el.gov_rne)?I:{},em=null!=(M=el.options_fiscales)?M:{},ex=null!=(F=el.checklist_conformite)?F:{},ep=el.titulaire_client,eh=null!=(U=null!=(T=null==(u=el.lieu_exercice)?void 0:u.adresse_etablissement)?T:null==(m=el.lieu_exercice)?void 0:m.adresse)?U:{},eg=d([eh.ligne1,eh.code_postal,eh.ville]," "),ev=null!=(q=null!=(P=null==(x=el.activite)?void 0:x.description)?P:null==(p=el.activite)?void 0:p.libelle)?q:"",ej=null!=(L=ec.SIREN)?L:ec.siren,ef=null!=(O=ec.SIRET_principal)?O:ec.siret,eb=null!=(V=ec.code_APE)?V:ec.ape,eN=null!=(H=eo.affiliation)?H:eo.statut,ey=null!=(B=eo.numero_affiliation)?B:eo.numero_compte,e_=null!=(J=el.options_sociales)?J:{};return(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"\uD83C\uDFE2 Mon entreprise"}),(0,i.jsxs)("div",{className:"bg-white border rounded p-4 space-y-5",children:[(0,i.jsxs)("div",{className:"border-b pb-3",children:[(0,i.jsx)("h4",{className:"font-semibold text-lg",children:r(el.denomination)}),(0,i.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mt-1",children:[(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Forme:"})," ",r(el.forme)]}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Statut:"})," ",r(el.statut_dossier)]}),(0,i.jsxs)("span",{children:[(0,i.jsx)("strong",{children:"Titulaire:"})," ",ep?(0,i.jsx)(l,{href:"/crm/clients/".concat(ep.id),className:"underline",children:r(d([ep.prenom,ep.nom]," "))}):"—"]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-blue-800 mb-2",children:"\uD83D\uDCCD Activit\xe9 & lieu"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm",children:[(0,i.jsxs)("li",{children:["Activit\xe9: ",r(ev)]}),(0,i.jsxs)("li",{children:["Cat\xe9gorie: ",r(null==(h=el.activite)?void 0:h.categorie)," — APE/NAF: ",r(null!=(z=null==(g=el.activite)?void 0:g.APE_NAF)?z:null==(v=el.activite)?void 0:v.code_ape)]}),(0,i.jsxs)("li",{children:["R\xe9glem.: ",a(null==(j=el.activite)?void 0:j.profession_reglementee)]}),(0,i.jsxs)("li",{children:["\xc9tablissement: ",eg]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-green-800 mb-2",children:"\uD83D\uDCC5 Dates importantes"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm",children:[(0,i.jsxs)("li",{children:["Demande: ",n(null!=(W=null==(f=el.dates)?void 0:f.date_demande)?W:null==(b=el.dates)?void 0:b.demande)]}),(0,i.jsxs)("li",{children:["D\xe9but d’activit\xe9: ",n(null!=(G=null==(N=el.dates)?void 0:N.date_debut_activite)?G:null==(y=el.dates)?void 0:y.debut_activite)]}),(0,i.jsxs)("li",{children:["Immatriculation r\xe9elle: ",n(null!=(K=null==(_=el.dates)?void 0:_.date_immatriculation_reelle)?K:null==(D=el.dates)?void 0:D.immatriculation_reelle)]})]})]}),(el.options_sociales||el.options_fiscales)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-purple-800 mb-2",children:"⚖️ Options sociales & fiscales"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm",children:[(0,i.jsxs)("li",{children:["R\xe9gime: ",r(e_.regime)]}),(0,i.jsxs)("li",{children:["P\xe9riodicit\xe9: ",r(null!=(Q=e_.periodicite_versement)?Q:e_.periodicite)]}),(0,i.jsxs)("li",{children:["Franchise TVA: ",a(null!=(X=em.franchise_TVA)?X:em.franchise_tva)]}),(0,i.jsxs)("li",{children:["N\xb0 TVA intracom: ",r(null!=(Y=em.numero_TVA_intracom)?Y:em.numero_tva)]}),(0,i.jsxs)("li",{children:["Versement lib\xe9ratoire IR: ",a(null!=(Z=em.versement_liberatoire_IR)?Z:em.versement_liberatoire)]}),(0,i.jsxs)("li",{children:["Compta simplifi\xe9e: ",a(em.comptabilite_simplifiee)]})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-red-800 mb-2",children:"\uD83C\uDFDB️ Donn\xe9es gouvernement"}),(0,i.jsxs)("ul",{className:"list-disc pl-6 text-sm",children:[(0,i.jsxs)("li",{children:["INPI: ",r(null!=($=ed.etat)?$:ed.statut)," — dossier ",r(null!=(ee=ed.numero_dossier)?ee:ed.dossier)," — MAJ ",n(null!=(et=ed.derniere_mise_a_jour)?et:ed.derniere_maj)]}),(0,i.jsxs)("li",{children:["INSEE/SIRENE — SIREN ",r(ej),", SIRET ",r(ef),", APE ",r(eb)]}),(0,i.jsxs)("li",{children:["URSSAF — ",r(eN),ey?", n\xb0 ".concat(ey):""]}),(0,i.jsxs)("li",{children:["RNE — ",r(null!=(es=eu.inscription)?es:eu.statut)]})]})]}),ex&&Object.keys(ex).length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-green-800 mb-2",children:"✅ Conformit\xe9 (checklist)"}),(0,i.jsx)("div",{className:"grid md:grid-cols-2 gap-2 text-sm",children:Object.entries(ex).map(e=>{let[t,s]=e,l="ok"===s||!0===s||1===s||"string"==typeof s&&"true"===s.toLowerCase(),n="ko"===s||!1===s||0===s||"string"==typeof s&&"false"===s.toLowerCase();return(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:l?"text-green-600":n?"text-red-600":"text-gray-500",children:l?"✅":n?"❌":"—"}),(0,i.jsxs)("span",{children:[t.replace(/_/g," "),": ",r(s)]})]},t)})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-gray-800 mb-2",children:"\uD83D\uDCCB Documents g\xe9n\xe9r\xe9s"}),en.length?(0,i.jsx)("ul",{className:"space-y-1 text-sm",children:en.map((e,t)=>(0,i.jsxs)("li",{children:[n(e.date)," — ",r(e.type)," — ",r(e.fichier)," — source ",r(e.source)]},t))}):(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"—"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-gray-800 mb-2",children:"\uD83D\uDD78️ Scraping jobs"}),ea.length?(0,i.jsx)("ul",{className:"space-y-1 text-sm",children:ea.map(e=>{var t,s;return(0,i.jsxs)("li",{children:[r(e.portail)," — ",r(e.etat)," — ",r(e.last_event)," — MAJ ",n(e.updated_at)]},null!=(s=e.id)?s:"".concat(e.portail,"-").concat(null!=(t=e.updated_at)?t:""))})}):(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"—"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h5",{className:"font-medium text-gray-800 mb-2",children:"\uD83D\uDCC2 Dossiers reli\xe9s"}),er.length?(0,i.jsx)("ul",{className:"space-y-1 text-sm",children:er.map(e=>(0,i.jsxs)("li",{children:["Dossier #",r(e.id)," — statut ",r(e.statut)," — client"," ",e.client_id?(0,i.jsxs)(l,{className:"underline",href:"/crm/clients/".concat(e.client_id),children:["#",r(e.client_id)]}):"—"]},e.id))}):(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"—"})]})]})]})}},7730:(e,t,s)=>{s.d(t,{A:()=>l});var i=s(5155);function l(e){let{relances:t=[],notifications:s=[]}=e,l=[...t,...s];return(l=l.sort((e,t)=>(new Date(t.scheduled_for).getTime()||0)-(new Date(e.scheduled_for).getTime()||0))).length?(0,i.jsxs)("section",{className:"bg-white border rounded p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCE8 Historique (relances & notifications)"}),(0,i.jsx)("ul",{className:"space-y-3",children:l.map(e=>{let t;return(0,i.jsxs)("li",{className:"border rounded p-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[e.type.startsWith("relance")?(0,i.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-100 text-amber-800",children:"Relance"}):(0,i.jsx)("span",{className:"text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800",children:"Notification"}),(0,i.jsx)("span",{className:"text-sm text-gray-600",children:e.canal||"—"})]}),(0,i.jsx)("div",{className:"text-xs text-gray-500",children:(t=e.scheduled_for)?new Date(t).toLocaleString("fr-FR"):"—"})]}),e.message&&""!==e.message.trim()?(0,i.jsx)("div",{className:"mt-1 text-sm text-gray-700 whitespace-pre-wrap",children:e.message}):(0,i.jsx)("div",{className:"mt-1 text-sm text-gray-400 italic",children:"Aucun message"})]},e.id)})})]}):(0,i.jsxs)("section",{className:"bg-white border rounded p-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83D\uDCE8 Historique (relances & notifications)"}),(0,i.jsx)("p",{className:"text-gray-500 text-sm",children:"Aucune relance ou notification programm\xe9e."})]})}},8386:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(5155);let l=e=>(null!=e?e:0===e)?String(e):"—";function n(e){var t,s;let n,{client:a}=e;if(!a)return null;let r=null!=(t=a.adresse_personnelle)?t:{},d=null!=(s=a.adresse_fiscale)?s:{};return(0,i.jsxs)("section",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\uD83C\uDD94 Identit\xe9 & adresses"}),(0,i.jsx)("div",{className:"bg-white border rounded p-4",children:(0,i.jsxs)("ul",{className:"list-disc pl-6",children:[(0,i.jsxs)("li",{children:["Naissance: ",(n=a.date_naissance)?new Date(n).toLocaleDateString("fr-FR"):"—"," — ",l(a.commune_naissance),", ",l(a.pays_naissance)," — ",l(a.nationalite)]}),(0,i.jsxs)("li",{children:["Adresse perso: ",l(r.ligne1),", ",l(r.code_postal)," ",l(r.ville)]}),(0,i.jsxs)("li",{children:["Adresse fiscale",d.est_differente?"":" (identique)",": ",l(d.ligne1),", ",l(d.code_postal)," ",l(d.ville)]}),(0,i.jsxs)("li",{children:["NIR: ",l(a.numero_securite_sociale)]})]})})]})}}}]);